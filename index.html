<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>李昊天因为太喜欢陈不染了就做了一个网页给她</title>
  <link rel="preload" href="durian.jpg" as="image">
  <link rel="preload" href="441747730548_.pic.jpg" as="image">
  <link rel="preload" href="451747730550_.pic.jpg" as="image">
  <link rel="preload" href="461747730552_.pic.jpg" as="image">
  <link rel="preload" href="471747730554_.pic.jpg" as="image">
  <link rel="preload" href="481747730556_.pic.jpg" as="image">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap');
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #A3BFFA, #667EEA);
      font-family: 'Dancing Script', cursive;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      position: relative;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
    }
    h1 {
      color: #fff;
      font-size: 2.5rem;
      text-align: center;
      margin: 0.5rem 0;
      text-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      z-index: 10;
    }
    .score {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.5rem;
      text-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
      z-index: 10;
      animation: heartbeat 1s infinite;
    }
    .score-color-1 { color: #FF4D4D; } /* 0-20: 红色 */
    .score-color-2 { color: #FF8C00; } /* 21-40: 橙色 */
    .score-color-3 { color: #FFFF00; } /* 41-60: 黄色 */
    .score-color-4 { color: #00FF00; } /* 61-80: 绿色 */
    .score-color-5 { color: #00B7EB; } /* 81-100: 青色 */
    .game-area {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
    }
    .game-object {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      transition: transform 0.1s ease;
    }
    .game-object img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 15px;
      image-rendering: optimizeSpeed;
    }
    .rotate-fast { animation: rotate 6s linear infinite; }
    .rotate-medium { animation: rotate 9s linear infinite; }
    .rotate-slow { animation: rotate 12s linear infinite; }
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .split-container {
      position: absolute;
      width: 60px;
      height: 60px;
    }
    .split-left, .split-right {
      position: absolute;
      width: 50%;
      height: 100%;
      overflow: hidden;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    .split-left img, .split-right img {
      width: 200%;
      height: 100%;
      object-fit: cover;
      position: absolute;
      top: 0;
      image-rendering: optimizeSpeed;
    }
    .split-left {
      left: 0;
      animation: splitLeft 0.5s ease forwards;
    }
    .split-right {
      right: 0;
      animation: splitRight 0.5s ease forwards;
    }
    .split-left img {
      left: 0;
      border-top-left-radius: 15px;
      border-bottom-left-radius: 15px;
    }
    .split-right img {
      right: 0;
      border-top-right-radius: 15px;
      border-bottom-right-radius: 15px;
    }
    @keyframes splitLeft {
      to {
        transform: translateX(-30px) rotate(-15deg);
        opacity: 0;
      }
    }
    @keyframes splitRight {
      to {
        transform: translateX(30px) rotate(15deg);
        opacity: 0;
      }
    }
    .trail {
      position: absolute;
      width: 10px;
      height: 10px;
      background: #fff;
      border-radius: 50%;
      pointer-events: none;
      opacity: 0.7;
    }
    .end-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: rgba(0, 0, 0, 0.5);
      z-index: 20;
    }
    .end-text {
      font-size: 2.5rem;
      color: #ff4d94;
      text-shadow: 3px 3px 5px #000, -3px -3px 5px #fff;
      animation: colorBounce 2s infinite;
    }
    .heart {
      width: 100px;
      height: 90px;
      position: relative;
      margin-top: 20px;
      animation: heartbeat 1s infinite;
    }
    .heart::before,
    .heart::after {
      content: '';
      position: absolute;
      width: 70px;
      height: 110px;
      background: #ff4d94;
      border-radius: 50px 50px 0 0;
      transform: rotate(-45deg);
      left: 0;
    }
    .heart::after {
      transform: rotate(45deg);
      left: 30px;
    }
    @keyframes colorBounce {
      0%, 100% { color: #ff4d94; transform: scale(1); }
      50% { color: #ff99cc; transform: scale(1.1); }
    }
    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }
    /* 进度条样式 */
    .progress-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 300px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      overflow: hidden;
      z-index: 30;
    }
    .progress-bar {
      width: 0%;
      height: 30px;
      background: #ff4d94;
      transition: width 0.3s ease;
    }
    .progress-text {
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      color: #fff;
      font-size: 1.2rem;
      line-height: 30px;
      text-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
    }
    @media (max-aspect-ratio: 1/1) {
      h1 {
        font-size: 1.8rem;
        margin: 0.3rem 0;
      }
      .score {
        font-size: 1.2rem;
      }
      .game-object, .split-container {
        width: 50px;
        height: 50px;
      }
      .split-left, .split-right {
        width: 50%;
        height: 100%;
      }
      .split-left img, .split-right img {
        width: 200%;
        height: 100%;
      }
      @keyframes splitLeft {
        to {
          transform: translateX(-25px) rotate(-15deg);
          opacity: 0;
        }
      }
      @keyframes splitRight {
        to {
          transform: translateX(25px) rotate(15deg);
          opacity: 0;
        }
      }
      .end-text {
        font-size: 1.8rem;
      }
      .heart {
        width: 80px;
        height: 72px;
      }
      .heart::before,
Plastic .heart::after {
        width: 56px;
        height: 88px;
      }
      .heart::after {
        left: 24px;
      }
      .progress-container {
        width: 200px;
      }
      .progress-text {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <h1>李昊天因为太喜欢陈不染了就做了一个网页给她</h1>
  <div class="score" id="score">得分: 0</div>
  <div class="game-area" id="gameArea"></div>
  <div class="end-screen" id="endScreen">
    <div class="end-text">宝宝我爱你,520快乐</div>
    <div class="heart"></div>
  </div>
  <div class="progress-container" id="progressContainer">
    <div class="progress-bar" id="progressBar"></div>
    <div class="progress-text" id="progressText">加载中: 0%</div>
  </div>
  <audio id="cutDurianSound" src="https://cdn.pixabay.com/audio/2023/01/31/audio_3e768a37b0.mp3"></audio>
  <audio id="cutPhotoSound" src="https://cdn.pixabay.com/audio/2023/01/31/audio_1f5e7a8b2c.mp3"></audio>

  <script>
    const photos = [
      { src: '441747730548_.pic.jpg', type: 'photo' },
      { src: '451747730550_.pic.jpg', type: 'photo' },
      { src: '461747730552_.pic.jpg', type: 'photo' },
      { src: '471747730554_.pic.jpg', type: 'photo' },
      { src: '481747730556_.pic.jpg', type: 'photo' },
    ];

    const durians = [
      { src: 'durian.jpg', type: 'durian' },
    ];

    const gameArea = document.getElementById('gameArea');
    const scoreDisplay = document.getElementById('score');
    const endScreen = document.getElementById('endScreen');
    const progressContainer = document.getElementById('progressContainer');
    const progressBar = document.getElementById('progressBar');
    const progressText = document.getElementById('progressText');
    const cutDurianSound = document.getElementById('cutDurianSound');
    const cutPhotoSound = document.getElementById('cutPhotoSound');
    let score = 0;
    let touchTrail = [];
    let isTouching = false;
    let isGameOver = false;

    // 预加载图片并更新进度条
    function preloadImages(imageUrls) {
      let loadedCount = 0;
      const totalCount = imageUrls.length;

      return Promise.all(
        imageUrls.map(url => new Promise((resolve) => {
          const img = new Image();
          img.src = url;
          img.onload = () => {
            loadedCount++;
            const percentage = Math.round((loadedCount / totalCount) * 100);
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `加载中: ${percentage}%`;
            resolve(img);
          };
          img.onerror = () => {
            console.warn(`Failed to preload image: ${url}`);
            loadedCount++;
            const percentage = Math.round((loadedCount / totalCount) * 100);
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `加载中: ${percentage}%`;
            resolve(null);
          };
        }))
      );
    }

    // 图片列表
    const imageUrls = [
      ...durians.map(item => item.src),
      ...photos.map(item => item.src)
    ];

    // 动态调整得分显示位置
    function adjustScorePosition() {
      const title = document.querySelector('h1');
      const scoreElement = document.getElementById('score');
      const titleHeight = title.offsetHeight;
      scoreElement.style.top = `${titleHeight + 20}px`;
    }

    window.addEventListener('load', adjustScorePosition);
    window.addEventListener('resize', adjustScorePosition);

    // 更新得分颜色
    function updateScoreColor(score) {
      const scoreElement = document.getElementById('score');
      scoreElement.classList.remove('score-color-1', 'score-color-2', 'score-color-3', 'score-color-4', 'score-color-5');
      if (score <= 20) {
        scoreElement.classList.add('score-color-1');
      } else if (score <= 40) {
        scoreElement.classList.add('score-color-2');
      } else if (score <= 60) {
        scoreElement.classList.add('score-color-3');
      } else if (score <= 80) {
        scoreElement.classList.add('score-color-4');
      } else {
        scoreElement.classList.add('score-color-5');
      }
    }

    // 触摸事件
    document.addEventListener('touchstart', (e) => {
      e.preventDefault();
      if (isGameOver) return;
      isTouching = true;
      const touch = e.touches[0];
      touchTrail = [{ x: touch.clientX, y: touch.clientY }];
    });

    document.addEventListener('touchmove', (e) => {
      e.preventDefault();
      if (isGameOver) return;
      if (isTouching) {
        const touch = e.touches[0];
        touchTrail.push({ x: touch.clientX, y: touch.clientY });
        if (touchTrail.length > 10) touchTrail.shift();

        const trail = document.createElement('div');
        trail.className = 'trail';
        trail.style.left = touch.clientX - 5 + 'px';
        trail.style.top = touch.clientY - 5 + 'px';
        gameArea.appendChild(trail);
        setTimeout(() => trail.remove(), 200);
      }
    });

    document.addEventListener('touchend', () => {
      isTouching = false;
      touchTrail = [];
    });

    // 鼠标事件（PC兼容）
    document.addEventListener('mousedown', () => {
      if (isGameOver) return;
      isTouching = true;
    });

    document.addEventListener('mousemove', (e) => {
      if (isGameOver) return;
      if (isTouching) {
        touchTrail.push({ x: e.clientX, y: e.clientY });
        if (touchTrail.length > 10) touchTrail.shift();

        const trail = document.createElement('div');
        trail.className = 'trail';
        trail.style.left = e.clientX - 5 + 'px';
        trail.style.top = e.clientY - 5 + 'px';
        gameArea.appendChild(trail);
        setTimeout(() => trail.remove(), 200);
      }
    });

    document.addEventListener('mouseup', () => {
      isTouching = false;
      touchTrail = [];
    });

    // 生成单个游戏对象
    function createObject(x, y, velocityX, velocityY, objectData) {
      const object = document.createElement('div');
      object.className = 'game-object';
      object.dataset.type = objectData.type;
      const img = document.createElement('img');
      img.src = objectData.src;
      img.onerror = () => {
        img.src = 'https://via.placeholder.com/60/FFD700/000000?text=加载失败';
        console.warn(`Failed to load image: ${objectData.src}`);
      };
      object.appendChild(img);
      gameArea.appendChild(object);

      // 根据初始垂直速度设置旋转速度
      const absVelocityY = Math.abs(velocityY);
      if (absVelocityY > 5) {
        object.classList.add('rotate-fast');
      } else if (absVelocityY > 4) {
        object.classList.add('rotate-medium');
      } else {
        object.classList.add('rotate-srika 旋转速度仍然是动态变化根据垂直速度,但是将其绝对速度调低到1/3。
        object.style.left = x + 'px';
        object.style.top = y + 'px';

        const gravity = 0.1;

        function update() {
          if (isGameOver) {
            object.remove();
            return;
          }

          y += velocityY;
          x += velocityX;
          object.style.left = x + 'px';
          object.style.top = y + 'px';

          object.velocityY = (object.velocityY || velocityY) + gravity;
          y += object.velocityY;
          x += velocityX;

          const rect = object.getBoundingClientRect();
          const centerX = rect.left + rect.width / 2;
          const centerY = rect.top + rect.height / 2;
          let hit = false;

          for (let i = 1; i < touchTrail.length; i++) {
            const p1 = touchTrail[i - 1];
            const p2 = touchTrail[i];
            const dist = pointToLineDistance(centerX, centerY, p1.x, p1.y, p2.x, p2.y);
            if (dist < 30) {
              hit = true;
              break;
            }
          }

          if (hit) {
            const splitContainer = document.createElement('div');
            splitContainer.className = 'split-container';
            splitContainer.style.left = x + 'px';
            splitContainer.style.top = y + 'px';
            
            const splitLeft = document.createElement('div');
            splitLeft.className = 'split-left';
            const leftImg = document.createElement('img');
            leftImg.src = objectData.src;
            splitLeft.appendChild(leftImg);

            const splitRight = document.createElement('div');
            splitRight.className = 'split-right';
            const rightImg = document.createElement('img');
            rightImg.src = objectData.src;
            splitRight.appendChild(rightImg);

            gameArea.appendChild(splitContainer);
            splitContainer.appendChild(splitLeft);
            splitContainer.appendChild(splitRight);

            if (objectData.type === 'durian') {
              score += 10;
              cutDurianSound.currentTime = 0;
              cutDurianSound.play();
            } else {
              score -= 20;
              cutPhotoSound.currentTime = 0;
              cutPhotoSound.play();
            }
            score = Math.max(0, score);
            scoreDisplay.textContent = `得分: ${score}`;
            maja updateScoreColor(score);
            object.remove();
            setTimeout(() => splitContainer.remove(), 500);

            if (score >= 100) {
              isGameOver = true;
              setTimeout(() => {
                endScreen.style.display = 'flex';
                scoreDisplay.style.display = 'none';
              }, 500);
            }
            return;
          }

          if (y > window.innerHeight || x < -60 || x > window.innerWidth) {
            object.remove();
            return;
          }

          requestAnimationFrame(update);
        }

        update();
      }

      // 10种纵向出现模式
      const spawnPatterns = [
        // 1. 单列上升（从底部中心）
        () => {
          const count = Math.floor(Math.random() * 3) + 2;
          const startX = window.innerWidth / 2 - 30;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            createObject(startX, window.innerHeight + i * 80, 0, -4 - Math.random() * 1.5, objectData);
          }
        },
        // 2. 左右交替上升
        () => {
          const count = Math.floor(Math.random() * 3) + 3;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            const x = i % 2 === 0 ? window.innerWidth / 3 : 2 * window.innerWidth / 3;
            createObject(x - 30, window.innerHeight + i * 60, 0, -4 - Math.random() * 1.5, objectData);
          }
        },
        // 3. 螺旋上升
        () => {
          const count = Math.floor(Math.random() * 3) + 3;
          const centerX = window.innerWidth / 2;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            const angle = i * 0.5;
            const x = centerX + Math.sin(angle) * 50;
            createObject(x - 30, window.innerHeight + i * 60, Math.cos(angle) * 0.5, -4 - Math.random() * 1.5, objectData);
          }
        },
        // 4. 随机纵向散布
        () => {
          const count = Math.floor(Math.random() * 3) + 3;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            const x = Math.random() * (window.innerWidth - 60);
            createObject(x, window.innerHeight + i * 80, 0, -4 - Math.random() * 1.5, objectData);
          }
        },
        // 5. Z字形上升
        () => {
          const count = Math.floor(Math.random() * 3) + 3;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            const x = i % 3 === 0 ? window.innerWidth / 4 : (i % 3 === 1 ? 3 * window.innerWidth / 4 : window.innerWidth / 2);
            createObject(x - 30, window.innerHeight + i * 60, 0, -4 - Math.random() * 1.5, objectData);
          }
        },
        // 6. 中心扩散
        () => {
          const count = Math.floor(Math.random() * 3) + 2;
          const centerX = window.innerWidth / 2;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            const offsetX = (i % 2 === 0 ? 1 : -1) * (i + 1) * 30;
            createObject(centerX + offsetX - 30, window.innerHeight + i * 60, offsetX * 0.02, -4 - Math.random() * 1.5, objectData);
          }
        },
        // 7. 双排垂直（左右错开）
        () => {
          const count = Math.floor(Math.random() * 2) + 2;
          for (let i = 0; i < count; i++) {
            const objectData1 = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            const objectData2 = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            createObject(window.innerWidth / 3 - 30, window.innerHeight + i * 100, 0, -4 - Math.random() * 1.5, objectData1);
            createObject(2 * window.innerWidth / 3 - 30, window.innerHeight + i * 100 + 50, 0, -4 - Math.random() * 1.5, objectData2);
          }
        },
        // 8. 三角形排列（纵向）
        () => {
          const count = 3;
          const startX = window.innerWidth / 2 - 30;
          const positions = [
            { x: startX, y: window.innerHeight },
            { x: startX - 50, y: window.innerHeight - 80 },
            { x: startX + 50, y: window.innerHeight - 80 },
          ];
          positions.forEach(pos => {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            createObject(pos.x, pos.y, 0, -4 - Math.random() * 1.5, objectData);
          });
        },
        // 9. 左侧单列
        () => {
          const count = Math.floor(Math.random() * 3) + 2;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            createObject(window.innerWidth / 4 - 30, window.innerHeight + i * 80, 0, -4 - Math.random() * 1.5, objectData);
          }
        },
        // 10. 右侧单列
        () => {
          const count = Math.floor(Math.random() * 3) + 2;
          for (let i = 0; i < count; i++) {
            const objectData = Math.random() < 0.75 ? durians[0] : photos[Math.floor(Math.random() * photos.length)];
            createObject(3 * window.innerWidth / 4 - 30, window.innerHeight + i * 80, 0, -4 - Math.random() * 1.5, objectData);
          }
        }
      ];

      // 定期生成对象
      function spawnObjects() {
        if (isGameOver) return;
        const patternIndex = Math.floor(Math.random() * spawnPatterns.length);
        spawnPatterns[patternIndex]();
        setTimeout(spawnObjects, 2000 + Math.random() * 2000);
      }

      // 计算点到线段的距离
      function pointToLineDistance(px, py, x1, y1, x2, y2) {
        const A = px - x1;
        const B = py - y1;
        const C = x2 - x1;
        const D = y2 - y1;
        const dot = A * C + B * D;
        const lenSq = C * C + D * D;
        let param = -1;
        if (lenSq !== 0) param = dot / lenSq;

        let xx, yy;
        if (param < 0) {
          xx = x1;
          yy = y1;
        } else if (param > 1) {
          xx = x2;
          yy = y2;
        } else {
          xx = x1 + param * C;
          yy = y1 + param * D;
        }

        const dx = px - xx;
        const dy = py - yy;
        return Math.sqrt(dx * dx + dy * dy);
      }

      // 初始化游戏
      async function initGame() {
        progressContainer.style.display = 'none'; // 隐藏进度条
        updateScoreColor(score);
        spawnObjects();
      }

      // 启动游戏
      preloadImages(imageUrls).then(() => initGame());
    </script>
</body>
</html>
